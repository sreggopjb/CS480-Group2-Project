<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description"
		content="A web app for viewing stock info, collected with the Trading View and Alpha Vantage APIs.">
	<title>Dashboard - Stock Info App</title>
	<!-- Bootstrap core CSS -->
	<!-- Custom styles for this template -->
	<link href="Styles/dashboard.css" rel="stylesheet">
	<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
	<header>
		<div class="overlay">
			<h1>Dashboard</h1>
		</div>

	</header>
	<main>

		<a href="info.html"><button class="glow-on-hover" type="button" >Edit</button></a>
		<div id="favorites">
		</div>
		<div id="add_popup">
			<button type="button" onclick="showAdd">Add Stock</button>
			<form id="add_form" action="add_stock()" method = "post">
				<input type="text" placeholder="Stock Symbol"><br>
				<input type="submit" value ="Add">
			</form>
		</div>
	</main>


	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="Scripts/index.js"></script>
	<script src="Scripts/cookie.js"></script>
    <script>
        // Get the user's favorite stocks from the cookie
        const favoriteStocks = JSON.parse(getFavoriteStocksCookie());
        if (favoriteStocks) {
            // Display the user's favorite stocks on the page
            const favoritesDiv = document.getElementById("favorites");
            for (let i = 0; i < favoriteStocks.length; i++) {
                const stock = favoriteStocks[i];
                const stockDiv = document.createElement("div");
                stockDiv.innerText = stock;
                favoritesDiv.appendChild(stockDiv);
            }
        }

        function addStock() {
            // Add the new stock to the favorites list
            const favoritesDiv = document.getElementById("favorites");
            const stockInput = document.querySelector("#add_form input[type='text']");
            const newStock = stockInput.value.toUpperCase();
            const stockDiv = document.createElement("div");
            stockDiv.innerText = newStock;
            favoritesDiv.appendChild(stockDiv);

            // Add the new stock to the user's favorite stocks in the cookie
            let favoriteStocks = JSON.parse(getFavoriteStocksCookie());
            if (!favoriteStocks) {
                favoriteStocks = [];
            }
            favoriteStocks.push(newStock);
            setFavoriteStocksCookie(JSON.stringify(favoriteStocks), 30);

            // Clear the input field
            stockInput.value = "";
        }
    </script>
</body>
</html>
